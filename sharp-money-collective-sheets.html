<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sharp Money Collective | Prediction Market Portfolio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
            border-bottom: 2px solid #0f3460;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #a0a0a0;
            font-size: 1rem;
            margin-top: 5px;
        }

        .loading {
            text-align: center;
            padding: 100px 20px;
            font-size: 1.2rem;
            color: #667eea;
        }

        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(102, 126, 234, 0.2);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 25px;
            backdrop-filter: blur(10px);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .stat-label {
            color: #a0a0a0;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #fff;
        }

        .stat-change {
            font-size: 0.9rem;
            margin-top: 8px;
            color: #a0a0a0;
        }

        .positive {
            color: #4ade80;
        }

        .negative {
            color: #f87171;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-high {
            background: rgba(248, 113, 113, 0.2);
            color: #f87171;
            border: 1px solid rgba(248, 113, 113, 0.3);
        }

        .badge-low {
            background: rgba(74, 222, 128, 0.2);
            color: #4ade80;
            border: 1px solid rgba(74, 222, 128, 0.3);
        }

        .position-card {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.2s;
        }

        .position-card:hover {
            border-color: rgba(102, 126, 234, 0.5);
            background: rgba(102, 126, 234, 0.05);
        }

        .position-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .position-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #fff;
            flex: 1;
        }

        .position-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            font-size: 0.9rem;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            color: #a0a0a0;
            font-size: 0.8rem;
            margin-bottom: 4px;
        }

        .detail-value {
            color: #fff;
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }

        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline-item {
            position: relative;
            padding-bottom: 30px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -23px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
            border: 3px solid #1a1a2e;
        }

        .timeline-item::after {
            content: '';
            position: absolute;
            left: -18px;
            top: 17px;
            width: 2px;
            height: calc(100% - 10px);
            background: rgba(102, 126, 234, 0.3);
        }

        .timeline-item:last-child::after {
            display: none;
        }

        .timeline-date {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .timeline-content {
            color: #e0e0e0;
        }

        footer {
            text-align: center;
            padding: 30px 0;
            color: #a0a0a0;
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 40px;
        }

        .error {
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid rgba(248, 113, 113, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            color: #f87171;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .position-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚ö° Sharp Money Collective</h1>
            <p class="subtitle">Data-Driven Prediction Market Portfolio</p>
            <p class="subtitle" style="margin-top: 5px; font-size: 0.85rem;" id="last-updated">Powered by Google Sheets</p>
        </header>

        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <div>Loading portfolio data from Google Sheets...</div>
        </div>

        <div id="error" style="display: none;"></div>

        <div id="content" style="display: none;">
            <div id="stats-section"></div>
            <div id="short-term-section"></div>
            <div id="long-term-section"></div>
            <div id="timeline-section"></div>
            <div id="scenarios-section"></div>

            <!-- Strategy Notes -->
            <div class="section">
                <h2 class="section-title">üìã Strategy & Philosophy</h2>
                <div style="display: grid; gap: 15px; font-size: 0.95rem; line-height: 1.6;">
                    <div style="display: flex; align-items: start; gap: 10px;">
                        <span style="color: #667eea; font-size: 1.2rem;">‚úì</span>
                        <div>
                            <strong style="color: #fff;">Data-Driven Analysis:</strong>
                            <span style="color: #a0a0a0;"> Hunt for markets where public information contradicts market prices</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: start; gap: 10px;">
                        <span style="color: #667eea; font-size: 1.2rem;">‚úì</span>
                        <div>
                            <strong style="color: #fff;">Disciplined Sizing:</strong>
                            <span style="color: #a0a0a0;"> 5-15% per position, max 30% deployed at once</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: start; gap: 10px;">
                        <span style="color: #667eea; font-size: 1.2rem;">‚úì</span>
                        <div>
                            <strong style="color: #fff;">Focus on Objectivity:</strong>
                            <span style="color: #a0a0a0;"> Prefer economic data and official statistics over speculation</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: start; gap: 10px;">
                        <span style="color: #667eea; font-size: 1.2rem;">‚úì</span>
                        <div>
                            <strong style="color: #fff;">Daily Check-ins:</strong>
                            <span style="color: #a0a0a0;"> 9 PM Pacific ‚Ä¢ Monitor positions and identify new opportunities</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div>Sharp Money Collective ‚Ä¢ Prediction Market Portfolio</div>
            <div style="margin-top: 10px; font-size: 0.85rem;">
                Platform: Kalshi ‚Ä¢ Challenge Period: Jan 25 - Feb 24, 2026
            </div>
        </footer>
    </div>

    <script>
        // ‚ö†Ô∏è REPLACE THIS WITH YOUR GOOGLE SHEET ID
        const SHEET_ID = '1cQYozw6ENaen_xwdeP86I0E6cJGuNMM_8ZnlYkJpljQ';

        const SHEETS = {
            meta: 'Meta',
            stats: 'Stats',
            positions: 'Positions',
            events: 'Events',
            scenarios: 'Scenarios'
        };

        async function fetchSheetData(sheetName) {
            const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;

            try {
                const response = await fetch(url);
                const text = await response.text();

                // Google Sheets returns JSONP, need to extract JSON
                const jsonMatch = text.match(/google\.visualization\.Query\.setResponse\((.*)\);/);
                if (!jsonMatch) throw new Error('Invalid response from Google Sheets');

                const json = JSON.parse(jsonMatch[1]);
                return json.table;
            } catch (error) {
                throw new Error(`Failed to fetch ${sheetName}: ${error.message}`);
            }
        }

        function parseSheetToKeyValue(table) {
            const data = {};
            if (!table || !table.rows) return data;

            table.rows.forEach(row => {
                if (row.c && row.c[0] && row.c[1]) {
                    const key = row.c[0].v;
                    const value = row.c[1].v;
                    data[key] = value;
                }
            });
            return data;
        }

        function parsePositions(table) {
            if (!table || !table.rows || table.rows.length < 2) return [];

            const headers = table.rows[0].c.map(cell => cell ? cell.v : '');
            const positions = [];

            for (let i = 1; i < table.rows.length; i++) {
                const row = table.rows[i];
                if (!row.c) continue;

                const position = {};
                headers.forEach((header, index) => {
                    if (row.c[index]) {
                        position[header] = row.c[index].v;
                    }
                });

                if (position.ID) {
                    positions.push(position);
                }
            }

            return positions;
        }

        function parseEvents(table) {
            if (!table || !table.rows || table.rows.length < 2) return [];

            const events = [];
            for (let i = 1; i < table.rows.length; i++) {
                const row = table.rows[i];
                if (!row.c || !row.c[0]) continue;

                events.push({
                    date: row.c[0] ? row.c[0].v : '',
                    time: row.c[1] ? row.c[1].v : '',
                    description: row.c[2] ? row.c[2].v : ''
                });
            }
            return events;
        }

        function parseScenarios(table) {
            if (!table || !table.rows || table.rows.length < 2) return [];

            const scenarios = [];
            for (let i = 1; i < table.rows.length; i++) {
                const row = table.rows[i];
                if (!row.c || !row.c[0]) continue;

                scenarios.push({
                    name: row.c[0] ? row.c[0].v : '',
                    emoji: row.c[1] ? row.c[1].v : 'üìä',
                    totalProfit: row.c[2] ? parseFloat(row.c[2].v) : 0,
                    finalBankroll: row.c[3] ? parseFloat(row.c[3].v) : 0,
                    returnPct: row.c[4] ? parseFloat(row.c[4].v) : 0
                });
            }
            return scenarios;
        }

        function renderPortfolio(data) {
            const { meta, stats, positions, events, scenarios } = data;

            // Update header
            document.getElementById('last-updated').textContent =
                `Last Updated: ${meta['Last Updated']} | Day ${meta['Day']}`;

            // Stats section
            document.getElementById('stats-section').innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Working Capital</div>
                        <div class="stat-value">$${parseFloat(stats['Working Capital Total']).toFixed(2)}</div>
                        <div class="stat-change">$${parseFloat(stats['Working Capital Available']).toFixed(2)} available ‚Ä¢ $${parseFloat(stats['Working Capital Pending']).toFixed(2)} pending</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Deployment Rate</div>
                        <div class="stat-value">${(parseFloat(stats['Deployment Rate']) * 100).toFixed(0)}%</div>
                        <div class="stat-change positive">‚úì Within target range</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Active Positions</div>
                        <div class="stat-value">${stats['Active Bets']}</div>
                        <div class="stat-change">${positions.filter(p => p.Type === 'short').length} short-term ‚Ä¢ ${positions.filter(p => p.Type === 'long').length} long-term</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Return</div>
                        <div class="stat-value">$${parseFloat(stats['Total Return']).toFixed(2)}</div>
                        <div class="stat-change">${parseFloat(stats['Total Return %']).toFixed(1)}% ‚Ä¢ ${stats['Settled Bets']} settled bets</div>
                    </div>
                </div>
            `;

            // Short-term positions
            const shortTerm = positions.filter(p => p.Type === 'short');
            if (shortTerm.length > 0) {
                const shortTermHtml = shortTerm.map(pos => `
                    <div class="position-card">
                        <div class="position-header">
                            <div class="position-title">${pos.Title}</div>
                            <span class="badge badge-${pos.Risk === 'low' ? 'low' : 'high'}">${pos.Risk} Risk</span>
                        </div>
                        <div class="position-details">
                            <div class="detail-item">
                                <span class="detail-label">Position</span>
                                <span class="detail-value">${pos.Position}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Amount Wagered</span>
                                <span class="detail-value">$${parseFloat(pos.Amount).toFixed(2)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Entry Price</span>
                                <span class="detail-value">$${parseFloat(pos['Entry Price']).toFixed(2)} (${(parseFloat(pos['Entry Price']) * 100).toFixed(0)}%)</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Potential Profit</span>
                                <span class="detail-value positive">+$${parseFloat(pos['Potential Profit']).toFixed(2)} (+${pos['Profit %']}%)</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Settlement</span>
                                <span class="detail-value">${pos.Settlement}</span>
                            </div>
                        </div>
                        ${pos['Est Prob'] && pos['Est Prob'] !== '-' ? `
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${parseFloat(pos['Est Prob']) * 100}%"></div>
                            </div>
                            <div style="margin-top: 8px; font-size: 0.85rem; color: #a0a0a0;">
                                Estimated true probability: ${(parseFloat(pos['Est Prob']) * 100).toFixed(1)}% (vs ${(parseFloat(pos['Market Prob']) * 100).toFixed(0)}% market price)
                            </div>
                        ` : ''}
                    </div>
                `).join('');

                document.getElementById('short-term-section').innerHTML = `
                    <div class="section">
                        <h2 class="section-title">üìä Active Short-Term Positions <span class="badge badge-low">Low Risk</span></h2>
                        ${shortTermHtml}
                    </div>
                `;
            }

            // Long-term positions
            const longTerm = positions.filter(p => p.Type === 'long');
            if (longTerm.length > 0) {
                const longTermHtml = longTerm.map(pos => `
                    <div class="position-card">
                        <div class="position-header">
                            <div class="position-title">${pos.Title}</div>
                            <span class="badge badge-high">${pos.Risk} Risk</span>
                        </div>
                        <div class="position-details">
                            <div class="detail-item">
                                <span class="detail-label">Amount Wagered</span>
                                <span class="detail-value">$${parseFloat(pos.Amount).toFixed(2)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Entry Price</span>
                                <span class="detail-value">$${parseFloat(pos['Entry Price']).toFixed(2)} (${(parseFloat(pos['Entry Price']) * 100).toFixed(0)}%)</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Potential Profit</span>
                                <span class="detail-value positive">+$${parseFloat(pos['Potential Profit']).toFixed(2)} (+${pos['Profit %']}%)</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Settlement</span>
                                <span class="detail-value">${pos.Settlement}</span>
                            </div>
                        </div>
                        ${pos.Reasoning ? `
                            <div style="margin-top: 12px; font-size: 0.85rem; color: #fbbf24;">
                                ‚ö†Ô∏è ${pos.Reasoning}
                            </div>
                        ` : ''}
                    </div>
                `).join('');

                document.getElementById('long-term-section').innerHTML = `
                    <div class="section">
                        <h2 class="section-title">üîí Locked Long-Term Positions <span class="badge badge-high">High Risk</span></h2>
                        ${longTermHtml}
                    </div>
                `;
            }

            // Timeline
            if (events.length > 0) {
                const timelineHtml = events.map(event => `
                    <div class="timeline-item">
                        <div class="timeline-date">${event.date}${event.time ? ` (${event.time})` : ''}</div>
                        <div class="timeline-content">${event.description}</div>
                    </div>
                `).join('');

                document.getElementById('timeline-section').innerHTML = `
                    <div class="section">
                        <h2 class="section-title">üìÖ Upcoming Events</h2>
                        <div class="timeline">${timelineHtml}</div>
                    </div>
                `;
            }

            // Scenarios
            if (scenarios.length > 0) {
                const scenariosHtml = scenarios.map(scenario => {
                    const color = scenario.returnPct > 50 ? '#4ade80' : scenario.returnPct > 0 ? '#fbbf24' : '#f87171';
                    return `
                        <div class="position-card">
                            <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 10px; color: ${color};">
                                ${scenario.emoji} ${scenario.name}
                            </div>
                            <div style="font-size: 1.8rem; font-weight: 700; color: #fff;">$${scenario.finalBankroll.toFixed(2)}</div>
                            <div style="margin-top: 8px; font-size: 0.9rem; color: #a0a0a0;">
                                ${scenario.totalProfit >= 0 ? '+' : ''}$${scenario.totalProfit.toFixed(2)} profit (${scenario.returnPct >= 0 ? '+' : ''}${scenario.returnPct}% from start)
                            </div>
                        </div>
                    `;
                }).join('');

                document.getElementById('scenarios-section').innerHTML = `
                    <div class="section">
                        <h2 class="section-title">üí∞ Portfolio Scenarios</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                            ${scenariosHtml}
                        </div>
                    </div>
                `;
            }
        }

        async function loadPortfolio() {
            try {
                // Check if Sheet ID is configured
                if (SHEET_ID === 'YOUR_SHEET_ID_HERE') {
                    throw new Error('Please configure your Google Sheet ID in the HTML file');
                }

                // Fetch all sheets
                const [metaTable, statsTable, positionsTable, eventsTable, scenariosTable] = await Promise.all([
                    fetchSheetData(SHEETS.meta),
                    fetchSheetData(SHEETS.stats),
                    fetchSheetData(SHEETS.positions),
                    fetchSheetData(SHEETS.events),
                    fetchSheetData(SHEETS.scenarios)
                ]);

                const data = {
                    meta: parseSheetToKeyValue(metaTable),
                    stats: parseSheetToKeyValue(statsTable),
                    positions: parsePositions(positionsTable),
                    events: parseEvents(eventsTable),
                    scenarios: parseScenarios(scenariosTable)
                };

                renderPortfolio(data);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('content').style.display = 'block';
                document.getElementById('error').style.display = 'none';
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').innerHTML = `
                    <div class="error">
                        <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 10px;">‚ùå Error Loading Portfolio</div>
                        <div>${error.message}</div>
                        <div style="margin-top: 15px; font-size: 0.9rem; opacity: 0.8;">
                            Make sure your Google Sheet is set to "Anyone with the link can view" and the Sheet ID is correct.
                        </div>
                    </div>
                `;
                document.getElementById('error').style.display = 'block';
            }
        }

        // Load on page load
        loadPortfolio();

        // Auto-refresh every 5 minutes
        setInterval(loadPortfolio, 5 * 60 * 1000);
    </script>
</body>
</html>